<!-- =====================================================
     INTERFACE D'INSCRIPTION - EXACTEMENT COMME L'EXEMPLE
     ===================================================== -->

<div class="register-container">
  <!-- Partie gauche - Branding -->
  <div class="left-section">
    <div class="brand-container">
      <!-- Logo TNB -->
      <div class="logo-circle">
        <span class="logo-text">TNB</span>
      </div>
      
      <!-- Titre -->
      <h1 class="main-title">Nouveau Compte</h1>
      
      <!-- Description -->
      <p class="description">
        Cr√©ez votre compte pour acc√©der au<br>
        syst√®me de gestion TNB. L'activation<br>
        sera effectu√©e par un administrateur.
      </p>
    </div>
  </div>

  <!-- Partie droite - Formulaire d'inscription -->
  <div class="right-section">
    <div class="form-container">
      <!-- Titre du formulaire -->
      <h2 class="form-title">Cr√©er un compte</h2>
      <p class="form-subtitle">Remplissez les informations ci-dessous</p>

      <!-- Formulaire -->
      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form">
        
        <!-- Ligne 1: Nom et Pr√©nom -->
        <div class="form-row">
          <div class="form-group half">
            <label for="nom" class="form-label">Nom *</label>
            <div class="input-container">
              <input 
                type="text" 
                id="nom"
                formControlName="nom"
                placeholder="Votre nom"
                class="form-input">
            </div>
            <div class="error-message" *ngIf="registerForm.get('nom')?.invalid && registerForm.get('nom')?.touched">
              {{ getFieldError('nom') }}
            </div>
          </div>

          <div class="form-group half">
            <label for="prenom" class="form-label">Pr√©nom *</label>
            <div class="input-container">
              <input 
                type="text" 
                id="prenom"
                formControlName="prenom"
                placeholder="Votre pr√©nom"
                class="form-input">
            </div>
            <div class="error-message" *ngIf="registerForm.get('prenom')?.invalid && registerForm.get('prenom')?.touched">
              {{ getFieldError('prenom') }}
            </div>
          </div>
        </div>

        <!-- Nom d'utilisateur -->
        <div class="form-group">
          <label for="username" class="form-label">Nom d'utilisateur *</label>
          <div class="input-container">
            <div class="input-icon-box">
              <mat-icon class="input-icon">person</mat-icon>
            </div>
            <input 
              type="text" 
              id="username"
              formControlName="username"
              placeholder="Nom d'utilisateur unique"
              class="form-input">
          </div>
          <div class="error-message" *ngIf="registerForm.get('username')?.invalid && registerForm.get('username')?.touched">
            {{ getFieldError('username') }}
          </div>
        </div>

        <!-- Email -->
        <div class="form-group">
          <label for="email" class="form-label">Email professionnel *</label>
          <div class="input-container">
            <div class="input-icon-box">
              <mat-icon class="input-icon">email</mat-icon>
            </div>
            <input 
              type="email" 
              id="email"
              formControlName="email"
              placeholder="votre.email@commune-oujda.ma"
              class="form-input">
          </div>
          <div class="error-message" *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
            {{ getFieldError('email') }}
          </div>
        </div>

        <!-- T√©l√©phone -->
        <div class="form-group">
          <label for="telephone" class="form-label">T√©l√©phone</label>
          <div class="input-container">
            <div class="input-icon-box">
              <span class="country-flag">üá≤üá¶</span>
            </div>
            <input 
              type="tel" 
              id="telephone"
              formControlName="telephone"
              placeholder="+212 6XX XX XX XX"
              class="form-input">
          </div>
          <div class="error-message" *ngIf="registerForm.get('telephone')?.invalid && registerForm.get('telephone')?.touched">
            {{ getFieldError('telephone') }}
          </div>
        </div>

        <!-- Profil demand√© -->
        <div class="form-group">
          <label class="form-label">Profil demand√© *</label>
          <div class="profile-selection">
            <div class="profile-grid">
              <label 
                class="profile-option"
                [class.selected]="registerForm.get('profil')?.value === 'AgentFiscal'"
                *ngFor="let role of userRoles">
                <input 
                  type="radio" 
                  name="profil"
                  [value]="role.value"
                  formControlName="profil">
                <div class="profile-content">
                  <mat-icon class="profile-icon">{{role.icon}}</mat-icon>
                  <span class="profile-title">{{role.label}}</span>
                  <span class="profile-desc">{{role.description}}</span>
                </div>
              </label>
            </div>
          </div>
          <div class="error-message" *ngIf="registerForm.get('profil')?.invalid && registerForm.get('profil')?.touched">
            {{ getFieldError('profil') }}
          </div>
        </div>

        <!-- Ligne mots de passe -->
        <div class="form-row">
          <div class="form-group half">
            <label for="password" class="form-label">Mot de passe *</label>
            <div class="input-container">
              <div class="input-icon-box">
                <mat-icon class="input-icon">lock</mat-icon>
              </div>
              <input 
                [type]="hidePassword ? 'password' : 'text'"
                id="password"
                formControlName="password"
                placeholder="Mot de passe"
                class="form-input">
              <div class="password-toggle-box" (click)="togglePasswordVisibility()">
                <mat-icon class="password-toggle-icon">
                  {{hidePassword ? 'visibility_off' : 'visibility'}}
                </mat-icon>
              </div>
            </div>
            <div class="error-message" *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
              {{ getFieldError('password') }}
            </div>
          </div>

          <div class="form-group half">
            <label for="confirmPassword" class="form-label">Confirmer *</label>
            <div class="input-container">
              <div class="input-icon-box">
                <mat-icon class="input-icon">lock</mat-icon>
              </div>
              <input 
                [type]="hideConfirmPassword ? 'password' : 'text'"
                id="confirmPassword"
                formControlName="confirmPassword"
                placeholder="Confirmer"
                class="form-input">
              <div class="password-toggle-box" (click)="toggleConfirmPasswordVisibility()">
                <mat-icon class="password-toggle-icon">
                  {{hideConfirmPassword ? 'visibility_off' : 'visibility'}}
                </mat-icon>
              </div>
            </div>
            <div class="error-message" *ngIf="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched">
              {{ getFieldError('confirmPassword') }}
            </div>
          </div>
        </div>

        <!-- Force du mot de passe -->
        <div class="password-strength" *ngIf="registerForm.get('password')?.value">
          <div class="strength-label">Force du mot de passe:</div>
          <div class="strength-bar">
            <div class="strength-fill" [class]="getPasswordStrength()"></div>
          </div>
          <div class="strength-text">{{ getPasswordStrengthText() }}</div>
        </div>

        <!-- Conditions d'utilisation -->
        <div class="form-group">
          <label class="checkbox-container">
            <input type="checkbox" formControlName="acceptTerms">
            <span class="checkmark"></span>
            <span class="checkbox-text">
              J'accepte les 
              <a href="#" class="terms-link">conditions d'utilisation</a> 
              et la 
              <a href="#" class="terms-link">politique de confidentialit√©</a>
            </span>
          </label>
          <div class="error-message" *ngIf="registerForm.get('acceptTerms')?.invalid && registerForm.get('acceptTerms')?.touched">
            Vous devez accepter les conditions d'utilisation
          </div>
        </div>

        <!-- Bouton de cr√©ation -->
        <button 
          type="submit" 
          class="register-button"
          [disabled]="registerForm.invalid || loading">
          <mat-spinner *ngIf="loading" diameter="20" class="button-spinner"></mat-spinner>
          <span *ngIf="!loading">Cr√©er le compte</span>
          <span *ngIf="loading">Cr√©ation...</span>
        </button>

        <!-- Lien de connexion -->
        <div class="login-link">
          <span>D√©j√† un compte ? </span>
          <a routerLink="/auth/login">Se connecter</a>
        </div>
      </form>
    </div>
  </div>
</div>