<div class="login-container">
  <div class="login-card-wrapper">
    <mat-card class="login-card">
      <mat-card-header class="login-header">
        <div class="logo-section">
          <img src="assets/images/logo/logo-tnb.png" alt="Logo TNB" class="logo">
          <h1>Géoportail TNB</h1>
          <p class="subtitle">Commune d'Oujda</p>
        </div>
      </mat-card-header>

      <mat-card-content>
        <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form" novalidate>
          <!-- Nom d'utilisateur -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Nom d'utilisateur</mat-label>
            <input 
              matInput 
              formControlName="username" 
              autocomplete="username"
              [class.error]="isFieldInvalid('username')"
              placeholder="Saisissez votre nom d'utilisateur">
            <mat-icon matSuffix>person</mat-icon>
            <mat-error *ngIf="username?.hasError('required')">
              Le nom d'utilisateur est requis
            </mat-error>
            <mat-error *ngIf="username?.hasError('minlength')">
              Minimum 3 caractères requis
            </mat-error>
          </mat-form-field>

          <!-- Mot de passe -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Mot de passe</mat-label>
            <input 
              matInput 
              [type]="hidePassword ? 'password' : 'text'"
              formControlName="password"
              autocomplete="current-password"
              [class.error]="isFieldInvalid('password')"
              placeholder="Saisissez votre mot de passe">
            <mat-icon 
              matSuffix 
              (click)="togglePasswordVisibility()" 
              class="password-toggle"
              [attr.aria-label]="'Afficher/masquer le mot de passe'"
              [attr.aria-pressed]="!hidePassword">
              {{ hidePassword ? 'visibility_off' : 'visibility' }}
            </mat-icon>
            <mat-error *ngIf="password?.hasError('required')">
              Le mot de passe est requis
            </mat-error>
            <mat-error *ngIf="password?.hasError('minlength')">
              Minimum 6 caractères requis
            </mat-error>
          </mat-form-field>

          <!-- Bouton de connexion -->
          <button 
            mat-raised-button 
            color="primary" 
            type="submit"
            class="login-button full-width"
            [disabled]="loginForm.invalid || isLoading"
            [attr.aria-label]="isLoading ? 'Connexion en cours' : 'Se connecter'">
            <mat-icon *ngIf="!isLoading">login</mat-icon>
            <mat-icon *ngIf="isLoading" class="spinning">hourglass_empty</mat-icon>
            <span *ngIf="!isLoading">Se connecter</span>
            <span *ngIf="isLoading">Connexion en cours...</span>
          </button>

          <!-- Barre de progression -->
          <mat-progress-bar 
            *ngIf="isLoading" 
            mode="indeterminate" 
            class="progress-bar"
            aria-label="Connexion en cours">
          </mat-progress-bar>
        </form>

        <!-- Actions secondaires -->
        <div class="secondary-actions">
          <button 
            mat-button 
            color="accent" 
            (click)="goToForgotPassword()"
            class="forgot-password-link"
            [disabled]="isLoading">
            <mat-icon>help_outline</mat-icon>
            Mot de passe oublié ?
          </button>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Informations système -->
    <div class="system-info">
      <p>
        <mat-icon>info</mat-icon>
        Système de gestion de la Taxe sur les Terrains Non Bâtis
      </p>
      <p class="version">Version 1.0.0</p>
    </div>
  </div>
</div>